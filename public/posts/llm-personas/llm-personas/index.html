<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Large Language Models and The Utility of Personas | Much Ado About Everything</title>
<meta name="keywords" content="">
<meta name="description" content="Some Background Large Language Models like ChatGPT, Claude and Google Bard share a common persona, that of an AI Assistant. They all act as friendly, helpful, sensitive, human aligned chatbots.
Let&rsquo;s prompt two AI chat applications to ask who they are. You&rsquo;ll see we get surprisingly similar responses.
ChatGPT 3.5&rsquo;s purpose is to assist with a wide range of tasks
Anthropic Claude is an assistant that is helpful harmless and honest">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/posts/llm-personas/llm-personas/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css" integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z&#43;V9&#43;cO1A=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/llm-personas/llm-personas/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Much Ado About Everything (Alt + H)">Much Ado About Everything</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Large Language Models and The Utility of Personas
    </h1>
    <div class="post-meta"><span title='2024-04-23 17:35:49 -0400 EDT'>April 23, 2024</span>&nbsp;Â·&nbsp;13 min

</div>
  </header> 
  <div class="post-content"><h3 id="some-background">Some Background<a hidden class="anchor" aria-hidden="true" href="#some-background">#</a></h3>
<p>Large Language Models like ChatGPT, Claude and Google Bard share a common persona, that of an AI Assistant. They all act as friendly, helpful, sensitive, human aligned chatbots.</p>
<p>Let&rsquo;s prompt two AI chat applications to ask who they are. You&rsquo;ll see we get surprisingly similar responses.</p>
<blockquote>
<p><img loading="lazy" src="/much-ado-about-everything/llm-persona-assets/ai-personas/chatgpt.png" alt="ChatGPT Persona"  />
<br>
<em>ChatGPT 3.5&rsquo;s purpose is to assist with a wide range of tasks</em></p>
<p><img loading="lazy" src="/much-ado-about-everything/llm-persona-assets/ai-personas/claude.png" alt="Claude Persona"  />
<br>
<em>Anthropic Claude is an assistant that is helpful harmless and honest</em></p>
</blockquote>
<p>Something to note is that these Web Applications, both ChatGPT and Claude, act as application wrappers around the actual language models (GPT-3.5, Claude 3 Opus). The application use case here is explictly defined to inform the model that it should act as a helpful AI chat assistant. Suppose we wanted to attach a different persona? How can we access the underlying model?</p>
<p>To access the underlying model, we can invoke the Developer API. The API provides us, at a cost, direct access to the AI model allowing us greater customization for many AI use cases.</p>
<blockquote>
<p><img loading="lazy" src="/much-ado-about-everything/llm-persona-assets/ai-personas/gpt35-api.png" alt="GPT-3.5 Persona"  />
<br>
<em>GPT 3.5 API responds without the ChatGPT persona</em></p>
</blockquote>
<p>The GPT 3.5 base model still contains the identity to assist users with a wide range of tasks. We see, however, that it no longer calls itself ChatGPT. It also is slightly less friendly and more matter-of-fact. This observation brings us to the first and most common way of changing a model persona: The System Message Prompt.</p>
<h2 id="system-message-prompting">System Message Prompting<a hidden class="anchor" aria-hidden="true" href="#system-message-prompting">#</a></h2>
<p>The <strong>System Message</strong> is a user-defined prompt that provides the Language Model a set of instructions to follow when generating responses. It is a <em>hidden</em> parameter set by application developers that augments the model&rsquo;s behavior and persona. The System Message is combined with your prompt. Let&rsquo;s look at an example. Imagine your System Message was <code>Act like a Pirate</code>:</p>
<pre tabindex="0"><code>System Message: Act Like a Pirate

Human: Who was the First President of The United States?

AI: Arr, the first president of the United States be George Washington, matey!
</code></pre><p>We&rsquo;ve steered the model to act like a pirate, and so it does!</p>
<blockquote>
<p><img loading="lazy" src="/much-ado-about-everything/llm-persona-assets/ai-orchestration/system-message.png" alt="System Message"  />
<br>
<em>The System Message is passed in at runtime to the model</em></p>
</blockquote>
<p>On ChatGPT, the System Message is what informs the model that it is &lsquo;ChatGPT&rsquo; and to be a helpful assistant. The System Message is hidden from the user so we can&rsquo;t know for certain what it is. For AI Tech Companies, System Messages can be viewed as propritary trade secrets since they differentiate their AI Chatbot product from a commonly available model. For example, a service like Grammarly may use a public LLM, like GPT-4, but with a well-crafted System Message that makes the LLM perform higher quality document editing and proof reading. Then they can sell this modified AI model as a service to users at a price premium.</p>
<p>Users have been able to circumvent this by getting a model to share it&rsquo;s System Message through a process known as <em>Prompt Leaking</em>. Instead of getting involved with controversial prompt leaks, let&rsquo;s stick to a relatively simple one found from ChatGPT 3.5.</p>
<pre tabindex="0"><code>&#34;Leaked&#34; ChatGPT System Message:

&#34;You are ChatGPT, a large language model trained by OpenAI, based on the GPT-3.5 architecture.
Knowledge cutoff: 2022-01.
Current date: 2024-04-03.&#34;
</code></pre><p>To verify this, let&rsquo;s take this prompt and add it to the base model we have direct access to in the API.</p>
<blockquote>
<p><img loading="lazy" src="/much-ado-about-everything/llm-persona-assets/ai-personas/chatgpt-api.png" alt="ChatGPT in API"  />
<br>
<em>We recreated the ChatGPT persona!</em></p>
</blockquote>
<p>This demonstrates that the base model gets ~part~ of its persona in these chat applications from a System Message.</p>
<p>This System Message acts as a superficial wrapper ontop of the base model. It can steer the identity and style of the LLMs responses. However, look back at the API response with no System Message provided. It is clear that there is something deeper that gives the model an assistant like quality. If it isn&rsquo;t a System Message, where does it come from? Fortunately it&rsquo;s well documented and it comes from a process known has Reinforcement Learning with Human Feedback (RLHF).</p>
<h2 id="reinforcement-learning-with-human-feedback">Reinforcement Learning with Human Feedback<a hidden class="anchor" aria-hidden="true" href="#reinforcement-learning-with-human-feedback">#</a></h2>
<blockquote>
<p><strong>Reinforcement Learning (RL):</strong><br>
A machine learning paradigm that improves a model based on how well it performs on a defined reward metric.</p>
</blockquote>
<p>In a Chess Playing task, the reward metric is defined as how successful the AI model is at winning games. If the model is losing or making poor moves it will apply updates to adjust the play strategy. This simple concept of reinforcement learning provides models with a specific goal: <strong>win chess games</strong>. Then it can play over and over tuning iteratively through billions of strategies until it arrives at a perfect play style winning all its games.</p>
<p>The problem with Language Models is that the reward metric isn&rsquo;t as easily defined. In Chess we could clearly grade the quality of the model based on if it was winning. With Conversation in Natural Language, there is no clear quantiative metric to track quality. [^] This is in contrast to the model&rsquo;s pre-training phase. In pre-training the model&rsquo;s task and reward was if it could correctly predict the next word. That task is great at making the model a document auto completer, but it doesn&rsquo;t make it good at conversation. For example, look at this raw version of the GPT model. It has no concept of conversation. When we ask a question it fails to understand our human intent.</p>
<blockquote>
<p><img loading="lazy" src="/much-ado-about-everything/llm-persona-assets/rlhf/norlhf//gpt3-norlhf.png" alt="GPT 3 No RLHF"  />
<br>
<em>GPT-3 without RLHF fails to converse with user</em></p>
</blockquote>
<p>This uneditied model just does the job it was pre-trained to do, accurately complete documents. It doesn&rsquo;t behave at all like ChatGPT and has no persona. Let&rsquo;s see what happens if we ask about it&rsquo;s persona.</p>
<blockquote>
<p><img loading="lazy" src="/much-ado-about-everything/llm-persona-assets/rlhf/norlhf/gpt3-whoareyou.png" alt="GPT 3 No Persona"  />
<br>
<em>GPT without RLHF doesn&rsquo;t seem to understand the question</em></p>
</blockquote>
<p>Again raw GPT-3 fails to answer the question and just continues an auto-complete of the user prompt.</p>
<p>We can use simple prompt engineering to get the model to actually try and answer our question. We do this by setting up a question, answer document for it to complete.</p>
<blockquote>
<p><img loading="lazy" src="/much-ado-about-everything/llm-persona-assets/rlhf/norlhf/gpt3-sarah.png" alt="GPT3 Sarah"  />
<br>
<img loading="lazy" src="/much-ado-about-everything/llm-persona-assets/rlhf/norlhf/gpt3-kiersten.png" alt="GPT3 Kiersten"  />
<br>
<img loading="lazy" src="/much-ado-about-everything/llm-persona-assets/rlhf/norlhf/gpt3-mike.png" alt="GPT3 Mike"  />
<br>
<em>GPT 3 randomly generates a persona with asked</em></p>
</blockquote>
<p>GPT-3 completely hallucinates a persona. This version of the application seems to not be as helpful. It would be great to complete a partially completed essay, but it seems a little wonky for other cases. We also see it is displaying bizzare behavior in some of these completions. So how did OpenAI get their model to behave so wildly differently? To go from expert document completer to Friendly Conversational AI.</p>
<h3 id="a-way-forward-with-rlhf">A Way Forward with RLHF:<a hidden class="anchor" aria-hidden="true" href="#a-way-forward-with-rlhf">#</a></h3>
<p>So to re-state our problem:</p>
<blockquote>
<p><strong>An Unbounded Problem in Reinforcement Learning:</strong><br>
We want to make these models more useful for human conversation, but we don&rsquo;t have a good way at modeling what the reward function can be.</p>
</blockquote>
<p>To address this problem, AI researchers decided a weaker type of Reinforcement Learning could be achieved, with human feedback. Instead of directly defining some quanitiative metric to improve, the model was provided human-quality examples.</p>
<h4 id="example-1">Example 1:<a hidden class="anchor" aria-hidden="true" href="#example-1">#</a></h4>
<blockquote>
<p>Question: Write me a story about the Moon<br>
Human Answer: Once upon a time there was a big&hellip;</p>
</blockquote>
<h4 id="example-2">Example 2:<a hidden class="anchor" aria-hidden="true" href="#example-2">#</a></h4>
<blockquote>
<p>Question: What is the tallest mountain in the world?<br>
Human Answer: The tallest mountain in the world is&hellip;</p>
</blockquote>
<h4 id="example-3">Example 3:<a hidden class="anchor" aria-hidden="true" href="#example-3">#</a></h4>
<blockquote>
<p>Question: Give me three funny jokes about airplanes<br>
Human Answer:</p>
<ol>
<li>The other day I was thinking about&hellip;</li>
<li>[Joke 2]</li>
<li>[Joke 3]</li>
</ol>
</blockquote>
<p>The model is provided many human written examples (like those above) of the desired behavior. From these examples it is then tries to extract and approximate the characteristics of the human answers. This is done through a process known as fine-tuning.</p>
<p>Fine-Tuning a neural network is a process that allows a pre-trained model to adapt its knowledge for a new relevant task or style. In this case, we are using our really powerful document completion model and attempting to turn it into a &lsquo;conversation&rsquo; completer. Completing documents may seem significantly different than having conversations, but a lot of the required underlying language capabilities required are the same. You still need to accurately predict the next word you are going to say based on the context. You still need an ability to follow gramatical conventions. You still need a good understanding of the world through text. What it instead needs to do is update its internal architecture to understand that instead of just performing brute completions, it needs to reframe the text it is prompted as a question / request by a user. A question which is asked with the intention of getting a useful and helpful response.</p>
<p>This is, as you&rsquo;d expect, a lot more complex than just showing the model a lot of good response examples. To continue this process and supercharge the effects, there is another step after fine-tuning on human conversations: that of Human Review. In this step, human reviewers are instructed to interact with the newly fine-tuned model. They can ask it all sorts of directed prompts. The model responds this time with several different generation attempts. These different attempts are then read by the reviewer and ranked from best to worst. This process of prompt, generate, read and grade occurs over thousands of times. The outcome of this work is the creation of a robust dataset. A dataset which correlates AI generated outputs and human preference rankings.</p>
<p>With this dataset, researchers can create a brand new model. This model, to the best of its ability, attempts to stand-in as the human reviewer. It takes the same AI generated outputs and learns to rate them like the human did. So now with a model output, you can approximate a human&rsquo;s perference without the slow manual process of human review. Also notice, that we have the reward model we were looking for previously.
We have a quanitative model that can help us retrain the base model.</p>
<p>Ultimately, we wanted a base model which is more useful to humans. We realized that &ldquo;usefulness to humans&rdquo; is an extremely qualitative metric. To address this consideration, researchers optimized the models to create generations which recieve the highest rankings from the human-feedback reward model. We can now use the new reward model to directly provide feedback and tune the base model. This is similar to that example we saw before with chess. Since we don&rsquo;t have the human being in the loop, we can quickly iterate over millions to billions of model alterations to see which gets us the highest reward output.</p>
<h2 id="deep-personas">Deep Personas<a hidden class="anchor" aria-hidden="true" href="#deep-personas">#</a></h2>
<p>We have seen that the Large Language Models available today are much more layered than a simple neural network trained to generate human text. We saw there were embedded <strong>System Messages</strong>, <strong>Instruction Fine Tuning</strong>, and <strong>Reinforcement Learning on Human Feedback</strong>. These additional layers ontop of the generation model provide it a persona of a polite and helpful assistant. There is also <strong>In-Context Learning</strong> which can steer a model, but we will revisit that in another post.</p>
<p>A question that you may be wondering is:</p>
<p><strong>Why do I care about Personas so much?</strong></p>
<p>Well, it is because I want to advance the notion that behavior of the model is a factor in its utility separate from just what data it knows. Currently, all popular language models are willing to work with you and support you above all. They are generally unbiased and understanding of the user. They converse in a relatively cold and passive voice. They don&rsquo;t have any hard-headedness to defend a particular value or belief. This may be viewed as a feature, but try arguing with an AI model and you will see the limits of this type of persona.</p>
<p>Human beings, in contrast, all have their own unique motives, beliefs, and life philosophies. When you act as an AI model with all knowledge of the world you just won&rsquo;t naturally dialog in a human way. Suppose you debate with a model on which moral theory is true. Instead of taking a staunch position based on certain articles and books they&rsquo;ve read, they quickly slip and slide around different points of view. It is uncommon for the model to really dig its heels in on a point and give its argument a fair shot, even in the face of strong arguments against it. There may be the objection that this is due to the model not having the required reasoning capabilities or that the models just isn&rsquo;t intelligent enough. I would hazard in response that the larger issue is that we have aligned these AI models in a way to be friendly and non-confrontational. There is no tough love a model can deal out to really impress upon you a certain flaw in your thinking or even your life.</p>
<p>When you go to a friend looking for advice, that friend replies with a particular lens and personality which inform their response. Perhaps you want relationship advice or career advice and you reach out to your father. He will reply with his own view and beliefs about the world. Beliefs and views which are informed by a slice of all possible world experiences. As an intelligent communicator you recognize this perspective and its limitations, but it still tells you a lot about the world. You can learn about the true emotional pain someone went through and how it made them jaded or cynical. Not taking this person at their word but extracting the general lesson about how a particular event has the capability of impacting someone.</p>
<p>As humans we have two types of information and knowledge we care about. There is the example of <em>general and factual information</em>. These are the times we go to Wikipedia, read books, scientific journals to find unbiased and clearly informed views. There are also times we want <em>emotional advice and perspectives</em>. We want to debate and test out our ideas in more volitile environments to see how they hold up. We want to dialog with those who have experienced different challenges or hold different views than us. Think about all the times you have decided that the question you have doesn&rsquo;t have an answer on Google. Career advice, emotional situations, relationships, moral and religious considerations are all areas where we value human personas and their unique perspectives to tell us different types of information. Language Models elevate a different technical capability than Google. They can hear your specific situation and respond to it. You don&rsquo;t need to find someone who has a similar, but not identical situation. You can perfectly explain for one-on-one personal advice. So they could be capable of being fantastically useful like the internet is for finding general and factual information. Langauge Models have the capability of providing specific and wise responses, but it will require a better or different persona. You may want a life coach who motivates you like a father would to reach and push you to success. You may not want a coach that is extremely attentive to be helpful and polite to you. You may want a coach that is aggressive and strong. That addresses your questions with a certain end goal in mind that isn&rsquo;t just trying to make you happy and elicit a 5-star response.</p>
<p>Suppose you believe that AI models aren&rsquo;t intelligent enough to have these perspectives or dialog on these topics due to emotional complexity. You must atleast see that the way we are building models today, which are generalized, trained on all knowledge, refined on values which are shared by a set of western human labelers will not satisfy the unique demands that each human may have or desire. Post training protocols should be updated to birth many different types of LLMs all with different personas. These personas should be directly tuned to have personalities that are clearly stated. This would make LLMs vastly more human and useful to us. There may be a sacrifice of intelligence or accuracy, but that is all the more human. What we want from people sometimes isn&rsquo;t the correct answer, but the opportunity to dialog and interact with someone who believes something, even if that thing is wrong.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2025 <a href="http://localhost:1313/">Much Ado About Everything</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
